
<body id="show-page">
  <div class='jumbotron'>
    <div class='row'>
      <div class='col-md-12'>
        <h2 class = "term-title"><%= term.term %></h2>
        <p class="short-def"><%= term.summary %></p>
        <a type="button" data-toggle="modal" data-target="#addDef">Add definition</a>
      </div>
    </div>
  </div>
  <div class='container'>
    <div class='row'>
      <% term.definitions.forEach(function(definition) { %>
      <div class='col-md-4'>

        <div class='definitions'>
          <form class="vote" id="" method="post" action="/upvote">
            <input type="hidden" class="form-control" value="<%= term.term %>" name="term" readonly>
            <input type="hidden" class="form-control" value="<%= definition.definition %>" name="definition" readonly>
            <button type="submit" name="upvote"  class="upvote"><i class="fa fa-chevron-up"></i></button>
            <input type="text" name="rating" value="<%= definition.rating %>" readonly>
            <i class="fa fa-chevron-down"></i>
          </form>
          <p class="rating"><%= definition.rating %></p>
          <p class="long-def"><%= definition.definition %></p>
          <a class="source" href="<%= definition.source %>">Source</a>
        </div>

      </div>
        <% }) %>
    </div>
  </div>

  <div id="addDef" class="modal fade" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h3 class="modal-title">Add a Definition </h3>
        </div>
        <div class="modal-body">
          <form method="post" action="/newdefinition">
            <div class="form-group">
              <input type="hidden" class="form-control" value="<%= term.term %>" name="term" readonly>
            </div>
            <div class="form-group">
              <label for="definition">Definition</label>
              <textarea class="form-control" id="definition" name="definition" rows="15"></textarea>
            </div>
            <div class="form-group">
              <label for="source">Source</label>
              <input type="url" class="form-control" id="source" name="source">
            </div>
              <button type="submit" class="btn btn-default btn-addterm">Add</button>
          </form>
        </div>
      </div>
    </div>
  </div>
  <script type="text/javascript">
    window.sr = ScrollReveal();
    sr.reveal('.definitions');
  </script>
  <script type="text/javascript">
    $(".upvote").on('click', function(event){
      event.preventDefault();

      var rating = $(this).siblings('.rating');

      $.post(this.href, function(response){
        rating.text(response.new_rating);

      // $.post({
      //     url: "/upvote",
      //     method: "POST",
      //     // data:
          }).done(function() {
   alert( "success" );
 }).fail(function() {
   alert( "failure" );
 }).always(function() {
   alert( "complete" );
 });
  });

  </script>
</body>
